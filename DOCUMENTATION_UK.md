# 🎮 Гра Herdsman - Повна Документація Розробника

## 📋 Зміст

1. [Огляд Проекту](#-огляд-проекту)
2. [Архітектура](#-архітектура)
3. [Структура Проекту](#-структура-проекту)
4. [Основні Системи](#-основні-системи)
5. [Об'єкти](#-обєкти)
6. [Системи](#-системи)
7. [UI Компоненти](#-ui-компоненти)
8. [Сервіси](#-сервіси)
9. [Конфігурація](#-конфігурація)
10. [Типи та Інтерфейси](#-типи-та-інтерфейси)
11. [Утиліти](#-утиліти)
12. [Збірка та Розробка](#-збірка-та-розробка)
13. [Тестування](#-тестування)
14. [API Довідник](#-api-довідник)

---

## 🎯 Огляд Проекту

**Гра Herdsman** - це сучасна веб-гра, створена з **TypeScript** та **PixiJS**. Гра містить персонажа-героя, який повинен збирати та доставляти тварин до призначеної зони. Проект слідує принципам чистої архітектури з модульним дизайном, ін'єкцією залежностей та комплексною підтримкою інтернаціоналізації.

### **Ключові Особливості:**
- 🎮 **Інтерактивний Геймплей**: Рух героя кліком/перетягуванням, механіка збору тварин
- 🌍 **Підтримка Багатьох Мов**: Англійська, Українська, Іспанська, Польська
- 📱 **Адаптивний Дизайн**: Підлаштовується під різні розміри екранів
- 🎨 **Сучасний UI**: Плавні анімації та професійний інтерфейс
- 🏗️ **Чиста Архітектура**: Принципи SOLID, модульний дизайн
- ⚡ **Оптимізована Продуктивність**: Ефективний рендеринг та управління пам'яттю

### **Технологічний Стек:**
- **Frontend**: TypeScript, PixiJS, HTML5, CSS3
- **Інструмент Збірки**: Vite
- **Тестування**: Vitest
- **Архітектура**: Чиста Архітектура, Ін'єкція Залежностей

---

## 🏗️ Архітектура

Проект слідує принципам **Чистої Архітектури** з чітким розділенням відповідальностей:

```
┌─────────────────────────────────────────────────────────────┐
│                    Шар Презентації                         │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐   │
│  │    UI       │ │  Об'єкти   │ │      Системи        │   │
│  │ Компоненти  │ │             │ │                     │   │
│  └─────────────┘ └─────────────┘ └─────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Шар Додатку                             │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐   │
│  │    Гра      │ │    App      │ │     EventBus        │   │
│  │ Контролер   │ │  Bootstrap  │ │                     │   │
│  └─────────────┘ └─────────────┘ └─────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Доменний Шар                            │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐   │
│  │   Сервіси   │ │    Типи     │ │     Утиліти         │   │
│  │             │ │             │ │                     │   │
│  └─────────────┘ └─────────────┘ └─────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Інфраструктурний Шар                    │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐   │
│  │   PixiJS    │ │  Сховище    │ │      Конфіг         │   │
│  │  Рендерер   │ │             │ │                     │   │
│  └─────────────┘ └─────────────┘ └─────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### **Використані Патерни Дизайну:**
- **Ін'єкція Залежностей**: Централізоване управління сервісами
- **Патерн Спостерігач**: Комунікація через події
- **Патерн Стану**: Управління станом гри
- **Стратегічний Патерн**: Різні режими руху
- **Фабричний Патерн**: Створення об'єктів
- **Командний Патерн**: Обробка вводу

---

## 📁 Структура Проекту

```
herdsman-game/
├── 📁 src/                          # Директорія вихідного коду
│   ├── 📁 core/                     # Основна логіка додатку
│   │   ├── App.ts                   # Основна ініціалізація додатку
│   │   ├── Game.ts                  # Контролер гри та оркестрація
│   │   ├── Clock.ts                 # Система часу та таймер
│   │   ├── EventBus.ts              # Система подій для комунікації
│   │   └── Container.ts             # Контейнер ін'єкції залежностей
│   │
│   ├── 📁 entities/                 # Об'єкти гри
│   │   ├── Hero.ts                  # Персонаж гравця
│   │   ├── Animal.ts                # Тварини для збору
│   │   ├── Yard.ts                  # Цільова зона доставки
│   │   └── Background.ts            # Фон гри
│   │
│   ├── 📁 systems/                  # Системи логіки гри
│   │   ├── InputSystem.ts           # Обробка вводу (клавіатура/миша)
│   │   ├── FollowSystem.ts          # Логіка слідування тварин
│   │   ├── PatrolSystem.ts          # Поведінка патрулювання тварин
│   │   ├── AutoDeliverSystem.ts     # Система автоматичної доставки
│   │   ├── CollisionSystem.ts       # Виявлення зіткнень
│   │   └── ScoreSystem.ts           # Управління рахунком
│   │
│   ├── 📁 ui/                       # Компоненти користувацького інтерфейсу
│   │   ├── HUD.ts                   # Індикатор (рахунок)
│   │   ├── StartOverlay.ts          # Екран початку гри
│   │   ├── PauseModal.ts            # Меню паузи з цікавими фактами
│   │   ├── CompletionModal.ts       # Екран завершення гри
│   │   └── LanguageSelector.ts      # Перемикання мови
│   │
│   ├── 📁 services/                 # Сервіси додатку
│   │   ├── AssetService.ts          # Завантаження та кешування ресурсів
│   │   ├── ConfigService.ts         # Управління конфігурацією
│   │   ├── I18nService.ts           # Інтернаціоналізація
│   │   ├── Logger.ts                # Система логування
│   │   └── StorageService.ts        # Управління локальним сховищем
│   │
│   ├── 📁 types/                    # Визначення типів TypeScript
│   │   ├── game.ts                  # Типи специфічні для гри
│   │   ├── entities.ts              # Інтерфейси об'єктів
│   │   ├── systems.ts               # Інтерфейси систем
│   │   ├── ui.ts                    # Інтерфейси UI компонентів
│   │   ├── i18n.ts                  # Типи інтернаціоналізації
│   │   ├── config.ts                # Типи конфігурації
│   │   └── index.ts                 # Експорт типів
│   │
│   ├── 📁 config/                   # Файли конфігурації
│   │   ├── game.json                # Параметри гри
│   │   ├── assets.json              # Мапінг файлів ресурсів
│   │   ├── i18n.json                # Рядки перекладів
│   │   ├── levels.json              # Визначення рівнів
│   │   └── keys.json                # Прив'язки клавіш
│   │
│   ├── 📁 utils/                    # Функції утиліт
│   │   ├── math.ts                  # Математичні утиліти
│   │   ├── geometry.ts              # Геометричні обчислення
│   │   └── throttle.ts              # Дроселювання функцій
│   │
│   ├── 📁 styles/                   # Стилізація
│   │   └── main.css                 # Основний таблиця стилів
│   │
│   ├── main.ts                      # Точка входу додатку
│   └── i18n.ts                      # Конфігурація i18n
│
├── 📁 tests/                        # Тестові файли
│   ├── setup.ts                     # Конфігурація тестів
│   └── 📁 utils/                    # Тести утиліт
│       └── math.test.ts             # Тести математичних утиліт
│
├── 📁 public/                       # Статичні ресурси
│   ├── 📁 assets/                   # Ресурси гри
│   │   ├── hero.png                 # Спрайт персонажа
│   │   ├── animal.png               # Спрайт тварини
│   │   ├── animal-on.png            # Спрайт тварини що слідує
│   │   ├── paddock.png              # Спрайт загону
│   │   ├── bg.png                   # Фонове зображення
│   │   └── favicon.ico              # Іконка сайту
│   └── 📁 fonts/                    # Файли шрифтів
│
├── 📄 package.json                  # Залежності та скрипти проекту
├── 📄 tsconfig.json                 # Конфігурація TypeScript
├── 📄 vite.config.ts                # Конфігурація збірки Vite
├── 📄 vitest.config.ts              # Конфігурація тестів Vitest
├── 📄 index.html                    # Основний HTML файл
├── 📄 manifest.json                 # PWA маніфест
└── 📄 README.md                     # README проекту
```

---

## ⚙️ Основні Системи

### 🎮 **App.ts** - Ініціалізація Додатку
Основний клас додатку, який ініціалізує рендерер PixiJS та основні сервіси.

```typescript
export class App {
  public readonly pixi: Application;        // Екземпляр додатку PixiJS
  public readonly clock: Clock;             // Система часу гри
  public readonly eventBus: EventBus;       // Система комунікації через події
  public readonly container: DIContainer;   // Контейнер ін'єкції залежностей
  
  private _state: GameState = 'boot';       // Поточний стан додатку
  private _isInitialized: boolean = false;  // Прапор ініціалізації
}
```

**Ключові Методи:**
- `initialize()`: Налаштовує рендерер PixiJS та основні сервіси
- `setState()`: Керує переходами стану додатку
- `destroy()`: Очищає ресурси та слухачі подій

### 🎯 **Game.ts** - Контролер Гри
Центральний оркестратор, який керує ігровим циклом, об'єктами, системами та UI.

```typescript
export class Game {
  private app: App;                    // Екземпляр додатку
  private gameContainer: Container;    // Основний контейнер сцени гри
  private systems: any[] = [];         // Активні ігрові системи
  private entities: any[] = [];        // Об'єкти гри
  private ui: any[] = [];              // UI компоненти
  private isRunning: boolean = false;  // Стан ігрового циклу
  private isPaused: boolean = false;   // Стан паузи
}
```

**Ключові Відповідальності:**
- **Управління Ігровим Циклом**: Контролює основний цикл оновлення гри
- **Управління Об'єктами**: Створює, оновлює та знищує ігрові об'єкти
- **Координація Систем**: Керує всіма ігровими системами та їх взаємодіями
- **Оркестрація UI**: Керує станом та взаємодіями користувацького інтерфейсу
- **Управління Станом**: Керує станами гри (завантаження, запуск, пауза, завершення)

---

## 🎭 Об'єкти

Об'єкти представляють ігрові об'єкти, які існують в ігровому світі.

### 🦸 **Hero.ts** - Персонаж Гравця
Головний персонаж, яким керує гравець.

```typescript
export class Hero implements IEntity, IMovable {
  public sprite: Sprite;                    // Спрайт PixiJS
  public position: Point;                   // Поточна позиція
  public velocity: Point;                   // Швидкість руху
  public target: Point | null;              // Ціль руху
  public movementMode: MovementMode;        // Поточний режим руху
  public isDragging: boolean;               // Стан перетягування
  public trail: Point[];                    // Слід руху
}
```

**Режими Руху:**
- `idle`: Не рухається
- `click`: Рухається до клікнутої позиції
- `drag`: Слідує за курсором миші
- `keyboard`: Рухається за допомогою клавіатури

### 🐑 **Animal.ts** - Тварини для Збору
Тварини, які можна збирати та доставляти до загону.

```typescript
export class Animal implements IEntity {
  public sprite: Sprite;                    // Спрайт PixiJS
  public position: Point;                   // Поточна позиція
  public velocity: Point;                   // Швидкість руху
  public state: AnimalState;                // Поточний стан
  public patrolTarget: Point | null;        // Ціль патрулювання
  public autoTarget: Point | null;          // Ціль автоматичної доставки
  public isDelivered: boolean;              // Статус доставки
}
```

**Стани Тварин:**
- `idle`: Не слідує, патрулює
- `following`: Слідує за героєм
- `autoDeliver`: Автоматично рухається до загону

---

## 🔧 Системи

Системи містять логіку гри та оновлюють об'єкти кожен кадр.

### 🎮 **InputSystem.ts** - Обробка Вводу
Керує вводом з клавіатури та миші для руху героя.

```typescript
export class InputSystem implements ISystem, IInputSystem {
  private hero: Hero;                       // Посилання на об'єкт героя
  private keys: Set<string>;                // Поточно натиснуті клавіші
  private keyConfig: KeyConfig;             // Конфігурація прив'язки клавіш
}
```

**Підтримуваний Ввід:**
- **Клавіатура**: WASD/Стрілки для руху
- **Миша**: Клік для руху, перетягування для слідування за курсором
- **Дотик**: Натискання та перетягування на мобільних пристроях

### 🐑 **FollowSystem.ts** - Слідування Тварин
Керує слідуванням тварин за героєм, коли вони наближаються достатньо близько.

### 🚶 **PatrolSystem.ts** - Патрулювання Тварин
Змушує тварин в стані очікування патрулювати по ігровій зоні.

### 🚚 **AutoDeliverSystem.ts** - Автоматична Доставка
Обробляє автоматичний рух тварин до загону, коли вони наближаються достатньо близько.

### 💥 **CollisionSystem.ts** - Виявлення Зіткнень
Виявляє, коли тварини потрапляють в загін та запускає доставку.

### 🏆 **ScoreSystem.ts** - Управління Рахунком
Керує рахунком гри та відстеженням рекорду.

---

## 🎨 UI Компоненти

UI компоненти обробляють користувацький інтерфейс та взаємодії користувача.

### 📊 **HUD.ts** - Індикатор
Відображає поточний рахунок та інформацію про гру.

### 🎬 **StartOverlay.ts** - Екран Початку Гри
Початковий екран, який показується при завантаженні гри.

### ⏸️ **PauseModal.ts** - Меню Паузи
Модальне вікно, яке показується при паузі гри.

### 🏁 **CompletionModal.ts** - Екран Завершення Гри
Модальне вікно, яке показується при завершенні гри.

### 🌍 **LanguageSelector.ts** - Перемикання Мови
Компонент для перемикання між різними мовами.

**Підтримувані Мови:**
- **Англійська** (`en`): Мова за замовчуванням
- **Українська** (`uk`): Український переклад
- **Іспанська** (`es`): Іспанський переклад
- **Польська** (`pl`): Польський переклад

---

## 🛠️ Сервіси

Сервіси надають основну функціональність та керують станом додатку.

### 📦 **AssetService.ts** - Управління Ресурсами
Обробляє завантаження та кешування ресурсів гри.

### ⚙️ **ConfigService.ts** - Управління Конфігурацією
Завантажує та надає доступ до конфігурації гри.

### 🌍 **I18nService.ts** - Інтернаціоналізація
Керує підтримкою кількох мов та перекладами.

### 📝 **Logger.ts** - Система Логування
Надає структуроване логування з різними рівнями.

### 💾 **StorageService.ts** - Локальне Сховище
Керує локальним сховищем браузера для збереження.

---

## ⚙️ Конфігурація

### 🎮 **game.json** - Параметри Гри
Основна конфігурація гри, включаючи властивості об'єктів та налаштування UI.

### 🎨 **assets.json** - Мапінг Ресурсів
Мапить логічні назви ресурсів на шляхи до файлів.

### 🌍 **i18n.json** - Переклади
Рядки перекладів для кількох мов.

---

## 📋 Типи та Інтерфейси

### 🎮 **game.ts** - Типи Гри
Основні визначення типів гри.

```typescript
export type GameState = 'boot' | 'running' | 'paused' | 'completed';
export type MovementMode = 'idle' | 'click' | 'drag' | 'keyboard';
export type AnimalState = 'idle' | 'following' | 'autoDeliver';
```

### 🎭 **entities.ts** - Інтерфейси Об'єктів
Визначення типів та інтерфейсів об'єктів.

### 🔧 **systems.ts** - Інтерфейси Систем
Визначення типів та інтерфейсів систем.

---

## 🛠️ Утиліти

### 🧮 **math.ts** - Математичні Утиліти
Загальні математичні функції та обчислення.

### 📐 **geometry.ts** - Геометричні Утиліти
Геометричні обчислення та операції з формами.

### ⏱️ **throttle.ts** - Дроселювання Функцій
Утиліта для дроселювання викликів функцій для покращення продуктивності.

---

## 🚀 Збірка та Розробка

### 📦 **Скрипти Пакету**
```bash
npm run dev      # Запустити сервер розробки
npm run build    # Зібрати для продакшену
npm run preview  # Попередній перегляд продакшен збірки
npm run test     # Запустити тести
npm run test:ui  # Запустити тести з UI
```

---

## 🧪 Тестування

### 🧪 **Конфігурація Тестів**
- **Фреймворк**: Vitest
- **Середовище**: jsdom (симуляція браузера)
- **Покриття**: Модульні тести для утиліт та основних функцій

---

## 📚 API Довідник

### 🎮 **API Класу Game**

#### **Конструктор**
```typescript
constructor()
```
Створює новий екземпляр Game з конфігурацією за замовчуванням.

#### **Методи**

##### **initialize()**
```typescript
async initialize(): Promise<void>
```
Ініціалізує гру, завантажує ресурси та налаштовує початковий стан.

##### **startGame()**
```typescript
startGame(): void
```
Запускає ігровий цикл та починає геймплей.

##### **pauseGame()**
```typescript
pauseGame(): void
```
Ставить гру на паузу та показує модальне вікно паузи.

##### **resumeGame()**
```typescript
resumeGame(): void
```
Продовжує гру зі стану паузи.

##### **resetGame()**
```typescript
resetGame(): void
```
Скидає гру до початкового стану.

---

## 🎯 **Висновок**

**Гра Herdsman** - це добре архітектурно побудована, сучасна веб-гра, яка демонструє:

- **Принципи Чистої Архітектури** з чітким розділенням відповідальностей
- **TypeScript** для безпеки типів та кращого досвіду розробки
- **PixiJS** для високопродуктивного 2D рендерингу
- **Модульний Дизайн** з ін'єкцією залежностей та комунікацією через події
- **Підтримку Інтернаціоналізації** для кількох мов
- **Адаптивний Дизайн**, який працює на різних розмірах екранів
- **Комплексне Тестування** з модульними тестами та правильною структурою тестів

Кодова база підтримувана, розширювана та слідує сучасним найкращим практикам веб-розробки. Кожен компонент має чітку відповідальність, а архітектура дозволяє легко додавати нові функції та модифікації.

---

*Ця документація охоплює повну структуру кодової бази, функціональність та шаблони використання. Для конкретних деталей реалізації зверніться до окремих вихідних файлів.*
